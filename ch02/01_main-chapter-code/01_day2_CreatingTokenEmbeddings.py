import torch


input_ids = torch.tensor([2, 3, 5, 1])

vocab_size = 6#嵌入层需要支持的唯一标记的总数
output_dim = 3#嵌入向量的维度

torch.manual_seed(123)#用于设置随机数生成器的种子，确保结果的可复现性
embedding_layer = torch.nn.Embedding(vocab_size, output_dim)#每行表示一个标记的嵌入向量。

print(embedding_layer.weight)
print(embedding_layer(torch.tensor([3])))
print(embedding_layer(input_ids))

# ### 故事背景：神奇的词汇翻译器
# 想象一下，你有一本神奇的字典，它能把每个单词变成一串数字，这些数字能描述单词的意思。这段代码就是在创建这样一个神奇的字典！

# ### 第1行：`import torch`
# ```python
# import torch
# ```

# **解释**：这行代码是在召唤一个叫「PyTorch」的魔法工具包，它里面有很多做AI魔法的工具。

# **类比**：就像你打开一个装满魔法道具的工具箱。

# ### 第3-4行：`input_ids = torch.tensor([2, 3, 5, 1])`
# ```python
# input_ids = torch.tensor([2, 3, 5, 1])
# ```

# **解释**：
# - `torch.tensor` 是一种能装数字的魔法容器
# - `[2, 3, 5, 1]` 是四个数字，每个数字代表一个单词（比如2=「猫」，3=「狗」，5=「鱼」，1=「我」）
# - 这些数字就像单词的身份证号

# **类比**：这四个数字是四个单词的「魔法编号」。

# ### 第6-7行：设置魔法参数
# ```python
# vocab_size = 6#嵌入层需要支持的唯一标记的总数
# output_dim = 3#嵌入向量的维度
# ```

# **解释**：
# - `vocab_size = 6`：我们的词汇表里总共有6个单词（编号从0到5）
# - `output_dim = 3`：每个单词要用3个数字来描述它的意思

# **类比**：
# - 词汇表就像一本有6个单词的字典
# - 每个单词要用3个魔法数字来描述（比如：猫=「柔软+可爱+小」，用[0.2, 0.8, 0.1]表示）

# ### 第9行：设置随机种子
# ```python
# torch.manual_seed(123)#用于设置随机数生成器的种子，确保结果的可复现性
# ```

# **解释**：这行代码是在设置魔法的「配方」，确保每次做魔法时得到的结果都一样。

# **类比**：就像你按照同一个食谱做蛋糕，每次做出来的味道都一样。

# ### 第10行：创建魔法嵌入层
# ```python
# embedding_layer = torch.nn.Embedding(vocab_size, output_dim)#每行表示一个标记的嵌入向量。
# ```

# **解释**：这是最关键的一行！我们创建了一个「魔法翻译器」：
# - 它能把单词的身份证号（数字）翻译成3个魔法数字
# - 每个单词的魔法数字都是独一无二的，能描述这个单词的意思

# **类比**：这就是我们的「神奇字典」，它能把「猫」的编号2变成[0.2, 0.8, 0.1]这样的魔法数字。

# ### 第12行：查看字典内容
# ```python
# print(embedding_layer.weight)
# ```

# **解释**：这行代码会打印出魔法字典里所有单词的魔法数字。

# **输出（类似这样）**：
# ```
# Parameter containing:
# tensor([[-0.1117, -0.3505, -0.5627],  # 单词0的魔法数字
#         [-0.8930,  0.8935,  0.4258],  # 单词1的魔法数字
#         [ 0.8694,  0.2381, -0.4248],  # 单词2的魔法数字（比如「猫」）
#         [ 0.9318, -0.4023, -0.5821],  # 单词3的魔法数字（比如「狗」）
#         [ 0.3283,  0.1857, -0.3077],  # 单词4的魔法数字
#         [ 0.7362, -0.5746,  0.6193]], # 单词5的魔法数字（比如「鱼」）
#        requires_grad=True)
# ```

# ### 第13行：翻译一个单词
# ```python
# print(embedding_layer(torch.tensor([3])))#翻译单词3
# ```

# **解释**：这行代码是在让魔法翻译器翻译编号为3的单词（比如「狗」）。

# **输出（类似这样）**：
# ```
# tensor([[ 0.9318, -0.4023, -0.5821]])
# ```

# 这三个数字就是「狗」的魔法描述！

# ### 为什么要这样做？
# - 计算机不能直接理解单词，但能理解数字
# - 这个魔法翻译器把单词变成数字后，计算机就能「理解」单词的意思了
# - 比如，「猫」和「狗」的数字会比较相似，因为它们都是动物

# ### 总结
# 这段代码创建了一个「神奇的单词翻译器」，能把每个单词的编号变成一串魔法数字，这样计算机就能理解单词的意思了！
# 个人理解：这里是将每个单词的编号映射到一个固定维度的向量空间中，每个向量代表该单词的语义信息。